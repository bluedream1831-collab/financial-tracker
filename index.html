<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²¡å‹™è‡ªç”±è¿½è¹¤ç³»çµ±ï¼ˆä¿å®ˆä¼°è¨ˆç‰ˆï¼‰| wcj å°ˆå±¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .editable-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            background: white;
            margin-bottom: 15px;
        }
        
        .editable-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }
        
        input[type="number"] {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 5px;
            font-size: 1.1em;
            width: 120px;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .summary-item {
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .summary-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .alert-info {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            color: #1e40af;
        }
        
        .alert-success {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            color: #065f46;
        }
        
        .alert-warning {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            color: #92400e;
        }
        
        .alert-danger {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
            color: #991b1b;
        }
        
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .expense-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .expense-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        
        .policy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .policy-item {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            background: #f9fafb;
        }
        
        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-bar-container {
            margin: 15px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .progress-bar-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .progress-bar-track {
            width: 100%;
            height: 25px;
            background: #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar-fill {
            height: 100%;
            transition: width 0.5s ease-out, background 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .progress-bar-fill.safe {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .progress-bar-fill.warning {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }
        
        .progress-bar-fill.danger {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }
        
        .margin-info {
            margin-top: 10px;
            padding: 10px;
            background: #f0f9ff;
            border-radius: 6px;
            font-size: 0.9em;
        }
        
        .margin-info.safe {
            background: #d1fae5;
            color: #065f46;
        }
        
        .margin-info.warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .margin-info.danger {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .total-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .total-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }
        
        @media print {
            body {
                background: white;
            }
            .button {
                display: none;
            }
            input[type="number"] {
                border: none;
                background: transparent;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¯ è²¡å‹™è‡ªç”±è¿½è¹¤ç³»çµ±ï¼ˆé€²éšç‰ˆ - ä¿å®ˆä¼°è¨ˆï¼‰</h1>
            <div style="color: #666; font-size: 1.2em; margin-top: 10px;">wcj å°ˆå±¬ | 38æ­² â†’ 45æ­²é”æ¨™è¨ˆç•«</div>
            <div style="color: #d97706; font-size: 1em; margin-top: 8px; font-weight: 500;">
                ğŸ“Š æ¡ç”¨4%ä¿å®ˆå¹´åŒ–å ±é…¬ç‡ | å¯¦éš›å ±é…¬ç‡è‹¥æ›´é«˜å‰‡å¯æå‰é”æ¨™
            </div>
            <div style="color: #999; font-size: 0.95em; margin-top: 5px;">âœ¨ åŠŸèƒ½ï¼šå€Ÿæ¬¾æ¯”é€²åº¦æ¢ + è·ŒæŠ—è¨ˆç®— + å¯ç·¨è¼¯åˆ©æ¯ + ç§‘å­¸é ä¼°</div>
            <div style="margin-top: 15px;">
                <button class="button" onclick="calculateAll()">ğŸ”„ é‡æ–°è¨ˆç®—å…¨éƒ¨</button>
                <button class="button" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°å ±å‘Š</button>
                <button class="button" onclick="saveData()">ğŸ’¾ å„²å­˜æ•¸æ“š</button>
                <button class="button" onclick="loadData()">ğŸ“‚ è¼‰å…¥æ•¸æ“š</button>
            </div>
        </div>

        <!-- è³‡ç”¢èˆ‡è² å‚µ -->
        <div class="section">
            <h2 class="section-title">ğŸ“Š è³‡ç”¢èˆ‡è² å‚µæ˜ç´°ï¼ˆå¯ç·¨è¼¯ï¼‰</h2>
            
            <div class="alert alert-info">
                <strong>ğŸ’¡ å¦‚ä½•ä½¿ç”¨ï¼š</strong>ç›´æ¥é»æ“Šæ•¸å­—å³å¯ä¿®æ”¹ï¼ä¿®æ”¹å¾ŒæŒ‰Enteræˆ–é»æ“Šå…¶ä»–åœ°æ–¹ï¼Œç³»çµ±æœƒè‡ªå‹•é‡æ–°è¨ˆç®—æ‰€æœ‰æ•¸æ“šã€‚<br>
                <strong>ğŸ¯ æ–°åŠŸèƒ½ï¼š</strong>æ¯å€‹é …ç›®éƒ½æœƒé¡¯ç¤ºå€Ÿæ¬¾æ¯”é€²åº¦æ¢å’Œè·é›¢è£œç¹³ç·šçš„å®‰å…¨è·é›¢ï¼Œä¸¦æ–°å¢ã€ŒæŠ•å…¥æˆæœ¬ã€èˆ‡ã€Œå ±é…¬ç‡ã€è¨ˆç®—ã€‚
            </div>

            <div class="alert alert-warning">
                <strong>âš ï¸ è£œç¹³ç·šèˆ‡æ–·é ­ç·š</strong><br>
                â€¢ <strong>ä¿å–®ABC</strong>ï¼š<br>
                  ã€€- å€Ÿæ¬¾æ¯”é”<strong>80%</strong> â†’ âš ï¸ è­¦æˆ’ç·šï¼Œå»ºè­°è£œç¹³<br>
                  ã€€- å€Ÿæ¬¾æ¯”é”<strong>90%</strong> â†’ ğŸš¨ æ”¶åˆ°è¿½ç¹³é€šçŸ¥ï¼Œé€šçŸ¥æ›¸åˆ°é”<strong>5æ—¥å…§å¿…é ˆé‚„æ¬¾</strong>ï¼Œå¦å‰‡æ–·é ­<br>
                â€¢ <strong>ä¿å–®D</strong>ï¼šå€Ÿæ¬¾æ¯”é”<strong>60%</strong>è£œç¹³ã€<strong>70%</strong>æ–·é ­<br>
                â€¢ <strong>ETFè³ªæŠ¼</strong>ï¼š<br>
                  ã€€- ç¶­æŒç‡ä½æ–¼<strong>145%</strong>ï¼ˆå€Ÿæ¬¾æ¯”69%ï¼‰â†’ ğŸ’› å¯å…ˆè¡Œè£œç¹³<br>
                  ã€€- ç¶­æŒç‡ä½æ–¼<strong>130%</strong>ï¼ˆå€Ÿæ¬¾æ¯”77%ï¼‰â†’ ğŸš¨ å¼·åˆ¶è¿½ç¹³ï¼ˆ2å€‹äº¤æ˜“æ—¥å…§è£œç¹³ï¼Œå¦å‰‡å¼·åˆ¶è³£è‚¡ï¼‰
            </div>

            <h3 style="color: #667eea; margin: 20px 0;">ä¿å–®è³‡ç”¢</h3>
            <div class="policy-grid">
                <!-- ä¿å–®A -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">ä¿å–®A - å®‰è¯æ”¶ç›Šæˆé•·</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æ·¨å€¼ï¼š</span>
                        <input type="number" id="asset_policy_a" value="47" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">å€Ÿæ¬¾ï¼š</span>
                        <input type="number" id="loan_policy_a" value="21.5" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æŠ•å…¥æˆæœ¬ï¼š</span>
                        <input type="number" id="cost_policy_a" value="50" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    
                    <!-- å€Ÿæ¬¾æ¯”é€²åº¦æ¢ -->
                    <div class="progress-bar-container">
                        <div class="progress-bar-header">
                            <span style="color: #666;">å€Ÿæ¬¾æ¯”</span>
                            <span id="ratio_policy_a" style="font-weight: bold; color: #10b981;">45.7%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div id="progress_policy_a" class="progress-bar-fill safe" style="width: 45.7%;">
                                45.7%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #999;">
                            <span>å®‰å…¨ 0%</span>
                            <span style="color: #f59e0b;">âš ï¸ 80%è­¦æˆ’</span>
                            <span style="color: #ef4444;">ğŸš¨ 90%è¿½ç¹³</span>
                        </div>
                    </div>
                    
                    <!-- è·ŒæŠ—è·é›¢ -->
                    <div id="margin_policy_a" class="margin-info safe">
                        <strong>ğŸ›¡ï¸ è·ŒæŠ—è·é›¢</strong><br>
                        è³‡ç”¢å¯ä¸‹è·Œ <strong>42.9%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                        å¯ä¸‹è·Œ <strong>49.2%</strong> æ‰åˆ°æ–·é ­ç·š
                    </div>
                    
                    <!-- å ±é…¬ç‡ -->
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        å ±é…¬ç‡ï¼š<span id="roi_policy_a">0.0</span>%
                    </div>
                </div>

                <!-- ä¿å–®B -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">ä¿å–®B - å®‰è¯æ”¶ç›Šæˆé•·</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æ·¨å€¼ï¼š</span>
                        <input type="number" id="asset_policy_b" value="146" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">å€Ÿæ¬¾ï¼š</span>
                        <input type="number" id="loan_policy_b" value="68.5" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æŠ•å…¥æˆæœ¬ï¼š</span>
                        <input type="number" id="cost_policy_b" value="150" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar-header">
                            <span style="color: #666;">å€Ÿæ¬¾æ¯”</span>
                            <span id="ratio_policy_b" style="font-weight: bold; color: #10b981;">46.9%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div id="progress_policy_b" class="progress-bar-fill safe" style="width: 46.9%;">
                                46.9%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #999;">
                            <span>å®‰å…¨ 0%</span>
                            <span style="color: #f59e0b;">âš ï¸ 80%è­¦æˆ’</span>
                            <span style="color: #ef4444;">ğŸš¨ 90%è¿½ç¹³</span>
                        </div>
                    </div>
                    
                    <div id="margin_policy_b" class="margin-info safe">
                        <strong>ğŸ›¡ï¸ è·ŒæŠ—è·é›¢</strong><br>
                        è³‡ç”¢å¯ä¸‹è·Œ <strong>41.4%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                        å¯ä¸‹è·Œ <strong>47.9%</strong> æ‰åˆ°æ–·é ­ç·š
                    </div>
                    
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        å ±é…¬ç‡ï¼š<span id="roi_policy_b">0.0</span>%
                    </div>
                </div>

                <!-- ä¿å–®C -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">ä¿å–®C - æ–½ç¾…å¾·ç’°çƒæ”¶ç›Š</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æ·¨å€¼ï¼š</span>
                        <input type="number" id="asset_policy_c" value="178" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">å€Ÿæ¬¾ï¼š</span>
                        <input type="number" id="loan_policy_c" value="84" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æŠ•å…¥æˆæœ¬ï¼š</span>
                        <input type="number" id="cost_policy_c" value="173" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar-header">
                            <span style="color: #666;">å€Ÿæ¬¾æ¯”</span>
                            <span id="ratio_policy_c" style="font-weight: bold; color: #10b981;">47.2%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div id="progress_policy_c" class="progress-bar-fill safe" style="width: 47.2%;">
                                47.2%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #999;">
                            <span>å®‰å…¨ 0%</span>
                            <span style="color: #f59e0b;">âš ï¸ 80%è­¦æˆ’</span>
                            <span style="color: #ef4444;">ğŸš¨ 90%è¿½ç¹³</span>
                        </div>
                    </div>
                    
                    <div id="margin_policy_c" class="margin-info safe">
                        <strong>ğŸ›¡ï¸ è·ŒæŠ—è·é›¢</strong><br>
                        è³‡ç”¢å¯ä¸‹è·Œ <strong>41.0%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                        å¯ä¸‹è·Œ <strong>47.6%</strong> æ‰åˆ°æ–·é ­ç·š
                    </div>
                    
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        å ±é…¬ç‡ï¼š<span id="roi_policy_c">0.0</span>%
                    </div>
                </div>

                <!-- ä¿å–®D -->
                <div class="policy-item" style="border-color: #10b981; border-width: 3px;">
                    <h4 style="color: #10b981; margin-bottom: 15px;">ä¿å–®D - å®‰è¯å…¨çƒæ”¶ç›Š â­</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æ·¨å€¼ï¼š</span>
                        <input type="number" id="asset_policy_d" value="324" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">å€Ÿæ¬¾ï¼š</span>
                        <input type="number" id="loan_policy_d" value="90" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æŠ•å…¥æˆæœ¬ï¼š</span>
                        <input type="number" id="cost_policy_d" value="301" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar-header">
                            <span style="color: #666;">å€Ÿæ¬¾æ¯”</span>
                            <span id="ratio_policy_d" style="font-weight: bold; color: #10b981;">27.8%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div id="progress_policy_d" class="progress-bar-fill safe" style="width: 27.8%;">
                                27.8%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #999;">
                            <span>å®‰å…¨ 0%</span>
                            <span style="color: #f59e0b;">âš ï¸ 60%</span>
                            <span style="color: #ef4444;">âŒ 70%</span>
                        </div>
                    </div>
                    
                    <div id="margin_policy_d" class="margin-info safe">
                        <strong>ğŸ›¡ï¸ è·ŒæŠ—è·é›¢</strong><br>
                        è³‡ç”¢å¯ä¸‹è·Œ <strong>53.7%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                        å¯ä¸‹è·Œ <strong>60.3%</strong> æ‰åˆ°æ–·é ­ç·š
                    </div>
                    
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        å ±é…¬ç‡ï¼š<span id="roi_policy_d">0.0</span>%
                    </div>
                </div>
            </div>

            <h3 style="color: #667eea; margin: 30px 0 20px 0;">å…¶ä»–è³‡ç”¢</h3>
            <div class="policy-grid">
                <!-- ETF -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">å°è‚¡é«˜è‚¡æ¯ETF</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æ·¨å€¼ï¼š</span>
                        <input type="number" id="asset_etf" value="173" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">è³ªæŠ¼å€Ÿæ¬¾ï¼š</span>
                        <input type="number" id="loan_etf" value="40" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æŠ•å…¥æˆæœ¬ï¼š</span>
                        <input type="number" id="cost_etf" value="175" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar-header">
                            <span style="color: #666;">å€Ÿæ¬¾æ¯”</span>
                            <span id="ratio_etf" style="font-weight: bold; color: #10b981;">23.1%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div id="progress_etf" class="progress-bar-fill safe" style="width: 23.1%;">
                                23.1%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #999;">
                            <span>å®‰å…¨ 0%</span>
                            <span style="color: #f59e0b;">ğŸ’› 69%ï¼ˆ145%ç¶­æŒç‡ï¼‰</span>
                            <span style="color: #ef4444;">ğŸš¨ 77%ï¼ˆ130%ç¶­æŒç‡ï¼‰</span>
                        </div>
                    </div>
                    
                    <div id="margin_etf" class="margin-info safe">
                        <strong>ğŸ›¡ï¸ è·ŒæŠ—è·é›¢</strong><br>
                        è³‡ç”¢å¯ä¸‹è·Œ <strong>70.0%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                        ç•¶å‰ç¶­æŒç‡ï¼š<strong>433%</strong>ï¼ˆé é«˜æ–¼130%å®‰å…¨ç·šï¼‰
                    </div>
                    
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        å ±é…¬ç‡ï¼š<span id="roi_etf">0.0</span>%ã€€|ã€€åŒ¯ç‡å°æ²– + æµå‹•æ€§å‚™ç”¨
                    </div>
                </div>

                <!-- ç¾é‡‘ -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">ç¾é‡‘</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">å¸³é¢ç¾é‡‘ï¼š</span>
                        <input type="number" id="asset_cash" value="45" step="0.1" min="0" onchange="calculateAll()"> è¬
                    </div>
                    <div style="margin: 10px 0; font-size: 0.9em; color: #999;">
                        + ETFå¯å€Ÿ 50è¬<br>
                        + å¾ªç’°ä¿¡è²¸å¯å€Ÿ 36è¬<br>
                        = ç¸½å¯å‹•ç”¨ <span style="font-weight: bold; color: #10b981;"><span id="total_available_cash">131</span>è¬</span>
                    </div>
                </div>

                <!-- æˆ¿è²¸èˆ‡ä¿¡è²¸ -->
                <div class="policy-item">
                    <h4 style="color: #333; margin-bottom: 15px;">æˆ¿è²¸èˆ‡ä¿¡è²¸</h4>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">æˆ¿è²¸é¤˜é¡ï¼š</span>
                        <input type="number" id="loan_mortgage" value="462" step="0.1" min="0" onchange="calculateAll()"> è¬
                        <div style="font-size: 0.9em; color: #999; margin-top: 5px;">åˆ©ç‡ 2.7%</div>
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #666;">ä¿¡è²¸é¤˜é¡ï¼š</span>
                        <input type="number" id="loan_credit" value="98" step="0.1" min="0" onchange="calculateAll()"> è¬
                        <div style="font-size: 0.9em; color: #999; margin-top: 5px;">æœˆé‚„æ¬¾ 13,000å…ƒï¼ˆå«æœ¬æ¯ï¼‰</div>
                    </div>
                </div>
            </div>

            <!-- ç¸½è¨ˆ -->
            <div class="total-box">
                <h3 style="color: white; margin-bottom: 20px;">ğŸ’° è³‡ç”¢è² å‚µç¸½è¦½</h3>
                <div class="total-grid">
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½è³‡ç”¢</div>
                        <div style="font-size: 2.2em; font-weight: bold;"><span id="total_assets">913</span>è¬</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½è² å‚µ</div>
                        <div style="font-size: 2.2em; font-weight: bold;"><span id="total_liabilities">764</span>è¬</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">æ·¨è³‡ç”¢</div>
                        <div style="font-size: 2.2em; font-weight: bold;"><span id="net_assets">149</span>è¬</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">æ•´é«”æ§“æ¡¿ç‡</div>
                        <div style="font-size: 2.2em; font-weight: bold;"><span id="leverage_ratio">83.7</span>%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ”¶æ”¯æ˜ç´° -->
        <div class="section">
            <h2 class="section-title">ğŸ’³ æ¯æœˆæ”¶æ”¯æ˜ç´°ï¼ˆå¯ç·¨è¼¯ï¼‰</h2>
            
            <h3 style="color: #10b981; margin: 20px 0;">ğŸ’° æ”¶å…¥</h3>
            <div class="expense-grid">
                <div class="expense-item" style="border-left-color: #10b981;">
                    <div style="color: #666; margin-bottom: 5px;">ä¸»å‹•æ”¶å…¥ï¼ˆå·¥ä½œï¼‰</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="income_active" value="42000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #10b981;">
                    <div style="color: #666; margin-bottom: 5px;">è¢«å‹•æ”¶å…¥ï¼ˆä¿å–®é…æ¯ï¼‰</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="income_passive" value="55000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <div style="opacity: 0.9; margin-bottom: 5px;">ç¸½æ”¶å…¥</div>
                    <div style="font-size: 1.8em; font-weight: bold;">
                        <span id="total_income">97,000</span> å…ƒ
                    </div>
                </div>
            </div>

            <h3 style="color: #3b82f6; margin: 30px 0 20px 0;">ğŸ  å›ºå®šæ”¯å‡º</h3>
            <div class="expense-grid">
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">æˆ¿è²¸</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_mortgage" value="15000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">ä¿¡è²¸</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_credit" value="13000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">ç”Ÿæ´»å¿…éœ€</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_living" value="15000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">ä¿éšª</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_insurance" value="8000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">é€šè¨Šç¶²è·¯</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_communication" value="2000" step="500" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item">
                    <div style="color: #666; margin-bottom: 5px;">é†«ç™‚ä¿å¥</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_health" value="4000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #3b82f6; background: #eff6ff;">
                    <div style="color: #1e40af; margin-bottom: 5px; font-weight: bold;">å›ºå®šæ”¯å‡ºå°è¨ˆ</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #3b82f6;">
                        <span id="total_fixed_expense">57,000</span> å…ƒ
                    </div>
                </div>
            </div>

            <h3 style="color: #f59e0b; margin: 30px 0 20px 0;">ğŸ‰ å½ˆæ€§æ”¯å‡ºï¼ˆå¯å£“ç¸®ï¼‰</h3>
            <div class="expense-grid">
                <div class="expense-item" style="border-left-color: #f59e0b;">
                    <div style="color: #666; margin-bottom: 5px;">å¨›æ¨‚ä¼‘é–’</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_entertainment" value="12000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #f59e0b;">
                    <div style="color: #666; margin-bottom: 5px;">æœé£¾è³¼ç‰©</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_shopping" value="5000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #f59e0b;">
                    <div style="color: #666; margin-bottom: 5px;">é€²ä¿®å­¸ç¿’</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_learning" value="3000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #f59e0b;">
                    <div style="color: #666; margin-bottom: 5px;">å…¶ä»–é›œæ”¯</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="expense_other" value="3000" step="1000" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #f59e0b; background: #fef3c7;">
                    <div style="color: #92400e; margin-bottom: 5px; font-weight: bold;">å½ˆæ€§æ”¯å‡ºå°è¨ˆ</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #f59e0b;">
                        <span id="total_flexible_expense">23,000</span> å…ƒ
                    </div>
                </div>
            </div>

            <h3 style="color: #ef4444; margin: 30px 0 20px 0;">ğŸ’¸ åˆ©æ¯æ”¯å‡ºï¼ˆå¯ç·¨è¼¯ï¼‰</h3>
            <div class="alert alert-info">
                <strong>âœ¨ æ–°åŠŸèƒ½ï¼š</strong>ä¿å–®å€Ÿæ¬¾åˆ©æ¯å’ŒETFè³ªæŠ¼åˆ©æ¯éƒ½å¯ä»¥æ‰‹å‹•ç·¨è¼¯ï¼Œæ–¹ä¾¿å¾®èª¿å¯¦éš›æ”¯å‡ºï¼
            </div>
            <div class="expense-grid">
                <div class="expense-item" style="border-left-color: #ef4444;">
                    <div style="color: #666; margin-bottom: 5px;">ä¿å–®å€Ÿæ¬¾åˆ©æ¯</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="interest_policy_input" value="8800" step="100" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                    <div style="font-size: 0.85em; color: #999; margin-top: 5px;">
                        å€Ÿæ¬¾ <span id="display_policy_loan">264</span>è¬ @ 4%<br>
                        è‡ªå‹•è¨ˆç®—å€¼ï¼š<span id="interest_policy_auto">8,800</span>å…ƒ
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #ef4444;">
                    <div style="color: #666; margin-bottom: 5px;">ETFè³ªæŠ¼åˆ©æ¯</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="interest_etf_input" value="100" step="10" min="0" onchange="calculateAll()">
                        <span>å…ƒ/æœˆ</span>
                    </div>
                    <div style="font-size: 0.85em; color: #999; margin-top: 5px;">
                        å€Ÿæ¬¾ <span id="display_etf_loan">40</span>è¬ @ 3%<br>
                        è‡ªå‹•è¨ˆç®—å€¼ï¼š<span id="interest_etf_auto">100</span>å…ƒ
                    </div>
                </div>
                <div class="expense-item" style="border-left-color: #ef4444; background: #fee2e2;">
                    <div style="color: #991b1b; margin-bottom: 5px; font-weight: bold;">æŠ•è³‡ç›¸é—œåˆ©æ¯å°è¨ˆ</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #ef4444;">
                        <span id="total_interest">8,900</span> å…ƒ/æœˆ
                    </div>
                    <div style="font-size: 0.85em; color: #999; margin-top: 5px;">
                        ä¿å–® + ETF åˆ©æ¯ï¼ˆå¯æ‰‹å‹•èª¿æ•´ï¼‰<br>
                        (æˆ¿è²¸ã€ä¿¡è²¸å·²å«åœ¨å›ºå®šæ”¯å‡ºä¸­)
                    </div>
                </div>
            </div>

            <!-- æ”¶æ”¯ç¸½è¦½ -->
            <div class="total-box" style="margin-top: 30px;">
                <h3 style="color: white; margin-bottom: 20px;">ğŸ“Š æ”¶æ”¯ç¸½è¦½</h3>
                <div class="total-grid">
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½æ”¶å…¥</div>
                        <div style="font-size: 2em; font-weight: bold;"><span id="display_total_income">97,000</span></div>
                        <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">å…ƒ/æœˆ</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½æ”¯å‡º</div>
                        <div style="font-size: 2em; font-weight: bold;"><span id="display_total_expense">78,252</span></div>
                        <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">å…ƒ/æœˆ</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">æœˆç›ˆé¤˜</div>
                        <div style="font-size: 2em; font-weight: bold;"><span id="monthly_surplus">18,748</span></div>
                        <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">å¯æŠ•è³‡é‡‘é¡</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">å„²è“„ç‡</div>
                        <div style="font-size: 2em; font-weight: bold;"><span id="saving_rate">19.3</span>%</div>
                        <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">ç›ˆé¤˜Ã·æ”¶å…¥</div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹´å¯æŠ•è³‡</div>
                        <div style="font-size: 2em; font-weight: bold;"><span id="annual_investment">224,976</span></div>
                        <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">å…ƒ/å¹´</div>
                    </div>
                </div>
            </div>

            <div class="alert alert-warning">
                <strong>ğŸ’¡ å„ªåŒ–å»ºè­°</strong><br>
                â€¢ ç›®æ¨™æœˆç›ˆé¤˜ï¼š2.5è¬ä»¥ä¸Šï¼ˆåŠ é€Ÿé”æ¨™ï¼‰<br>
                â€¢ å½ˆæ€§æ”¯å‡ºå¯å£“ç¸®ç©ºé–“ï¼š1-1.5è¬<br>
                â€¢ æˆ–å¢åŠ ä¸»å‹•æ”¶å…¥ï¼šç›®æ¨™5-6è¬/æœˆ<br>
                â€¢ æé«˜å„²è“„ç‡åˆ°25-30%æœ€ç†æƒ³
            </div>
        </div>

        <!-- é”æ¨™è©•ä¼° -->
        <div class="section">
            <h2 class="section-title">ğŸ¯ 45æ­²é”æ¨™è©•ä¼°</h2>
            
            <div class="alert alert-info">
                <strong>ğŸ“ ç•¶å‰ç‹€æ…‹</strong><br>
                å¹´é½¡ï¼š38æ­² | è·é›¢45æ­²ï¼š<strong>7å¹´</strong><br>
                æœˆé…æ¯ï¼š<strong><span id="display_passive_income">5.5</span>è¬</strong> | 
                ç›®æ¨™ï¼š<strong>7è¬</strong> | 
                é‚„å·®ï¼š<strong><span id="gap_to_target">1.5</span>è¬</strong><br>
                é”æˆç‡ï¼š<strong><span id="completion_rate">79</span>%</strong>
            </div>

            <div class="alert alert-warning">
                <strong>âš ï¸ é‡è¦èªªæ˜ï¼šé ä¼°æ¡ç”¨ä¿å®ˆä¼°è¨ˆ</strong><br>
                â€¢ æœ¬ç³»çµ±é ä¼°ä½¿ç”¨<strong>4%å¹´åŒ–å ±é…¬ç‡</strong>ï¼ˆä¿å®ˆæƒ…å¢ƒï¼‰<br>
                â€¢ å¯¦éš›å ±é…¬ç‡å¯èƒ½æ›´é«˜æˆ–æ›´ä½ï¼Œè«‹å®šæœŸæª¢è¦–èª¿æ•´<br>
                â€¢ è‹¥å¯¦éš›å ±é…¬ç‡é”5%ï¼Œ45æ­²æœˆé…æ¯æœƒæ›´é«˜<br>
                â€¢ å»ºè­°ï¼šå¯§å¯ä¿å®ˆé ä¼°ï¼Œæå‰é”æ¨™ç¸½æ¯”å»¶é²å¥½ï¼
            </div>

            <!-- é€²åº¦æ¢ -->
            <div style="margin: 30px 0;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span style="font-weight: bold; color: #667eea;">é…æ¯é€²åº¦</span>
                    <span style="font-weight: bold; color: #667eea;"><span id="progress_percentage">79</span>%</span>
                </div>
                <div style="width: 100%; height: 40px; background: #e5e7eb; border-radius: 20px; overflow: hidden; position: relative;">
                    <div id="progress_bar" style="height: 100%; background: linear-gradient(90deg, #10b981, #059669); width: 79%; transition: width 1s ease-out; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.1em;">
                        <span id="progress_text">5.5è¬ / 7è¬</span>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 0.9em; color: #666;">
                    <span>èµ·é» 0è¬</span>
                    <span style="color: #10b981; font-weight: bold;">ç›®æ¨™ 7è¬</span>
                </div>
            </div>

            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">å¹´æŠ•è³‡é¡ï¼ˆä¾æœˆç›ˆé¤˜ï¼‰</div>
                    <div class="summary-value" style="color: #667eea;"><span id="display_annual_inv">22.5</span>è¬</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">7å¹´ç´¯ç©æŠ•å…¥ï¼ˆæœ¬é‡‘ï¼‰</div>
                    <div class="summary-value" style="color: #667eea;"><span id="seven_year_inv">157.5</span>è¬</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">é ä¼°45æ­²æ·¨å€¼ï¼ˆ4%å ±é…¬ç‡ï¼‰</div>
                    <div class="summary-value" style="color: #10b981;"><span id="estimated_networth_45">1,000</span>è¬</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">é ä¼°45æ­²æœˆé…æ¯ï¼ˆ4%é…æ¯ç‡ï¼‰</div>
                    <div class="summary-value" style="color: #10b981;"><span id="estimated_income_45">6.8</span>è¬</div>
                </div>
            </div>

            <div class="alert alert-success">
                <strong>âœ… é”æ¨™é æ¸¬</strong><br>
                <span id="target_prediction">
                åŸºæ–¼ç•¶å‰æœˆç›ˆé¤˜<strong><span id="pred_surplus">1.9</span>è¬</strong>ï¼Œé ä¼°ï¼š<br>
                â€¢ 45æ­²é”æ¨™æ©Ÿç‡ï¼š<strong>60-65%</strong>ï¼ˆé…æ¯ç´„6.8è¬ï¼‰<br>
                â€¢ 46æ­²é”æ¨™æ©Ÿç‡ï¼š<strong>80-85%</strong>ï¼ˆé…æ¯ç´„7.2è¬ï¼‰<br>
                â€¢ 47æ­²é”æ¨™æ©Ÿç‡ï¼š<strong>95%+</strong>ï¼ˆé…æ¯ç´„7.5è¬ï¼‰
                </span>
            </div>

            <div class="alert alert-warning">
                <strong>ğŸš€ åŠ é€Ÿé”æ¨™æ–¹æ¡ˆ</strong><br>
                <small style="color: #92400e;">âš ï¸ æœ¬ç³»çµ±æ¡ç”¨<strong>ä¿å®ˆä¼°è¨ˆ4%å¹´åŒ–å ±é…¬ç‡</strong>ï¼Œè‹¥å¯¦éš›å ±é…¬ç‡æ›´é«˜å‰‡å¯æå‰é”æ¨™</small><br><br>
                è‹¥è¦æé«˜45æ­²é”æ¨™æ©Ÿç‡åˆ°70%+ï¼Œå»ºè­°ï¼š<br>
                â€¢ <strong>æ–¹æ¡ˆä¸€ï¼ˆæœ€é‡è¦ï¼‰</strong>ï¼šæé«˜æœˆç›ˆé¤˜åˆ°<strong>2.8-3è¬</strong>ï¼ˆé–‹æº+5åƒã€ç¯€æµ-4åƒï¼‰<br>
                â€¢ <strong>æ–¹æ¡ˆäºŒ</strong>ï¼šè³£å‡º50è¬ETF â†’ æŠ•å…¥ä¿å–®Dï¼ˆæé«˜å ±é…¬ç‡ï¼‰<br>
                â€¢ <strong>æ–¹æ¡ˆä¸‰</strong>ï¼šä¿å–®Dé…æ¯å…¨éƒ¨å†æŠ•è³‡ï¼ˆæ¯æœˆç´„2.16è¬ï¼‰<br>
                â€¢ <strong>æ–¹æ¡ˆå››</strong>ï¼šä¿å–®Då¢åŠ å€Ÿæ¬¾åˆ°40%ï¼ˆå¢æ§“ç´„40è¬ï¼‰<br>
                <small style="color: #92400e;">ğŸ’¡ è©³ç´°åˆ†æè«‹åƒè€ƒã€ŒåŠ é€Ÿé”æ¨™åˆ†æã€å ±å‘Š</small>
            </div>
        </div>

        <!-- æ“ä½œèªªæ˜ -->
        <div class="section">
            <h2 class="section-title">ğŸ“– ä½¿ç”¨èªªæ˜</h2>
            
            <div style="line-height: 2;">
                <h4 style="color: #667eea; margin: 15px 0;">âœ¨ æ–°åŠŸèƒ½èªªæ˜</h4>
                <ol style="margin-left: 20px;">
                    <li><strong>å€Ÿæ¬¾æ¯”é€²åº¦æ¢</strong>ï¼šæ¯å€‹ä¿å–®å’ŒETFéƒ½æœ‰è¦–è¦ºåŒ–é€²åº¦æ¢ï¼Œæ¸…æ¥šé¡¯ç¤ºç•¶å‰å€Ÿæ¬¾æ¯”ä¾‹</li>
                    <li><strong>è·ŒæŠ—è·é›¢è¨ˆç®—</strong>ï¼šè‡ªå‹•è¨ˆç®—è³‡ç”¢å¯ä»¥ä¸‹è·Œå¤šå°‘%æ‰æœƒè§¸åŠè£œç¹³ç·šå’Œæ–·é ­ç·š</li>
                    <li><strong>å¯ç·¨è¼¯åˆ©æ¯</strong>ï¼šä¿å–®å€Ÿæ¬¾åˆ©æ¯å’ŒETFè³ªæŠ¼åˆ©æ¯éƒ½å¯ä»¥æ‰‹å‹•èª¿æ•´ï¼Œæ›´è²¼è¿‘å¯¦éš›ç‹€æ³</li>
                    <li><strong>å„è³‡ç”¢æŠ•å…¥æˆæœ¬</strong>ï¼šæ¯å¼µä¿å–®èˆ‡ETFéƒ½å¯è¼¸å…¥ã€ŒæŠ•å…¥æˆæœ¬ã€ï¼Œç³»çµ±è‡ªå‹•è¨ˆç®—å ±é…¬ç‡</li>
                    <li><strong>å®‰å…¨è­¦ç¤º</strong>ï¼šæ ¹æ“šå€Ÿæ¬¾æ¯”è‡ªå‹•è®Šè‰²ï¼ˆç¶ è‰²å®‰å…¨ã€é»ƒè‰²è­¦æˆ’ã€ç´…è‰²å±éšªï¼‰</li>
                </ol>

                <h4 style="color: #667eea; margin: 15px 0;">ğŸ”§ å¦‚ä½•ä¿®æ”¹æ•¸æ“š</h4>
                <ol style="margin-left: 20px;">
                    <li>ç›´æ¥é»æ“Šä»»ä½•æ•¸å­—æ¡†é€²è¡Œç·¨è¼¯</li>
                    <li>ä¿®æ”¹å¾ŒæŒ‰Enteréµæˆ–é»æ“Šå…¶ä»–åœ°æ–¹</li>
                    <li>ç³»çµ±æœƒè‡ªå‹•é‡æ–°è¨ˆç®—æ‰€æœ‰ç›¸é—œæ•¸æ“š</li>
                    <li>æˆ–é»æ“Šã€ŒğŸ”„ é‡æ–°è¨ˆç®—å…¨éƒ¨ã€æŒ‰éˆ•æ‰‹å‹•åˆ·æ–°</li>
                </ol>

                <h4 style="color: #667eea; margin: 15px 0;">ğŸ’¾ å¦‚ä½•å„²å­˜æ•¸æ“š</h4>
                <ol style="margin-left: 20px;">
                    <li>é»æ“Šã€ŒğŸ’¾ å„²å­˜æ•¸æ“šã€æŒ‰éˆ•</li>
                    <li>æ•¸æ“šæœƒä¿å­˜åœ¨ç€è¦½å™¨æœ¬åœ°å„²å­˜</li>
                    <li>ä¸‹æ¬¡é–‹å•Ÿæœƒè‡ªå‹•è¼‰å…¥ä¸Šæ¬¡çš„æ•¸æ“š</li>
                    <li>å¯ä»¥é»æ“Šã€ŒğŸ“‚ è¼‰å…¥æ•¸æ“šã€æ‰‹å‹•è¼‰å…¥</li>
                </ol>

                <h4 style="color: #667eea; margin: 15px 0;">ğŸ–¨ï¸ å¦‚ä½•åˆ—å°å ±å‘Š</h4>
                <ol style="margin-left: 20px;">
                    <li>é»æ“Šã€ŒğŸ–¨ï¸ åˆ—å°å ±å‘Šã€æŒ‰éˆ•</li>
                    <li>é¸æ“‡åˆ—å°æˆ–å„²å­˜ç‚ºPDF</li>
                    <li>åˆ—å°æ™‚æœƒè‡ªå‹•éš±è—æŒ‰éˆ•å’Œç·¨è¼¯æ¡†é‚Šæ¡†</li>
                </ol>

                <h4 style="color: #667eea; margin: 15px 0;">ğŸ“Š æ¯æœˆæ›´æ–°å»ºè­°</h4>
                <ol style="margin-left: 20px;">
                    <li>æ¯æœˆ5è™Ÿæ›´æ–°æ‰€æœ‰ä¿å–®æ·¨å€¼</li>
                    <li>æ›´æ–°å¯¦éš›æ”¶æ”¯é‡‘é¡</li>
                    <li>æª¢æŸ¥å€Ÿæ¬¾æ¯”æ˜¯å¦åœ¨å®‰å…¨ç¯„åœ</li>
                    <li>è©•ä¼°è·ŒæŠ—è·é›¢æ˜¯å¦å……è¶³</li>
                    <li>æ ¹æ“šå¯¦éš›åˆ©æ¯æ”¯å‡ºå¾®èª¿ä¿å–®å€Ÿæ¬¾åˆ©æ¯å’ŒETFè³ªæŠ¼åˆ©æ¯</li>
                </ol>

                <h4 style="color: #667eea; margin: 15px 0;">âš ï¸ å®‰å…¨æé†’</h4>
                <ul style="margin-left: 20px;">
                    <li><strong>ä¿å–®ABC</strong>ï¼šå»ºè­°å€Ÿæ¬¾æ¯”ç¶­æŒåœ¨<strong>70%ä»¥ä¸‹</strong>ï¼Œç•™10%ç·©è¡ç©ºé–“</li>
                    <li><strong>ä¿å–®D</strong>ï¼šå»ºè­°å€Ÿæ¬¾æ¯”ç¶­æŒåœ¨<strong>50%ä»¥ä¸‹</strong>ï¼Œç•™10%ç·©è¡ç©ºé–“</li>
                    <li><strong>ETFè³ªæŠ¼</strong>ï¼š
                        <ul style="margin-top: 5px; margin-left: 20px;">
                            <li>å»ºè­°å€Ÿæ¬¾æ¯”ç¶­æŒåœ¨<strong>60%ä»¥ä¸‹</strong>ï¼ˆç¶­æŒç‡167%ä»¥ä¸Šï¼‰</li>
                            <li>å€Ÿæ¬¾æ¯”<strong>69%</strong>ï¼ˆç¶­æŒç‡145%ï¼‰â†’ ğŸ’› åˆ¸å•†å¯èƒ½æé†’ï¼Œå»ºè­°å…ˆè¡Œè£œç¹³</li>
                            <li>å€Ÿæ¬¾æ¯”<strong>77%</strong>ï¼ˆç¶­æŒç‡130%ï¼‰â†’ ğŸš¨ æ”¶åˆ°è¿½ç¹³é€šçŸ¥ï¼Œ<strong>2å€‹äº¤æ˜“æ—¥å…§</strong>å¿…é ˆè£œç¹³</li>
                            <li>æœªè£œç¹³ â†’ å¼·åˆ¶è³£è‚¡å›è£œï¼Œå¯èƒ½é€ æˆæå¤±</li>
                        </ul>
                    </li>
                    <li>å®šæœŸæª¢æŸ¥è·ŒæŠ—è·é›¢ï¼Œç¢ºä¿è‡³å°‘æœ‰<strong>30%ä»¥ä¸Š</strong>çš„å®‰å…¨ç©ºé–“</li>
                    <li><strong>ğŸ’¡ ETFç¶­æŒç‡è¨ˆç®—</strong>ï¼šç¶­æŒç‡ = ETFæ·¨å€¼ Ã· å€Ÿæ¬¾é‡‘é¡ Ã— 100%</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // å®‰å…¨æ›´æ–°å…ƒç´ å…§å®¹çš„è¼”åŠ©å‡½æ•¸
        function safeSetText(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = value;
            } else {
                console.warn(`å…ƒç´  ${elementId} ä¸å­˜åœ¨`);
            }
        }

        function safeSetStyle(elementId, property, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.style[property] = value;
            } else {
                console.warn(`å…ƒç´  ${elementId} ä¸å­˜åœ¨`);
            }
        }

        function safeSetHTML(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = value;
            } else {
                console.warn(`å…ƒç´  ${elementId} ä¸å­˜åœ¨`);
            }
        }

        // è¨ˆç®—å€Ÿæ¬¾æ¯”å’Œè·ŒæŠ—è·é›¢
        function calculateLeverageInfo(asset, loan, marginCall, liquidation) {
            const ratio = asset > 0 ? (loan / asset * 100) : 0;
            const marginCallDropPct = ratio > 0 ? ((1 - ratio / marginCall) * 100) : 100;
            const liquidationDropPct = ratio > 0 ? ((1 - ratio / liquidation) * 100) : 100;
            
            let status = 'safe';
            if (ratio >= liquidation * 0.9) {
                status = 'danger';
            } else if (ratio >= marginCall * 0.85) {
                status = 'warning';
            }
            
            return {
                ratio: ratio,
                marginCallDropPct: marginCallDropPct,
                liquidationDropPct: liquidationDropPct,
                status: status
            };
        }

        // è¨ˆç®—å ±é…¬ç‡
        function calculateROI(asset, cost) {
            if (!cost || cost <= 0) return 0;
            return (asset - cost) / cost * 100;
        }

        // æ›´æ–°é€²åº¦æ¢å’Œè·ŒæŠ—ä¿¡æ¯
        function updateProgressBar(id, info, marginCall, liquidation) {
            // æ›´æ–°å€Ÿæ¬¾æ¯”é¡¯ç¤º
            safeSetText('ratio_' + id, info.ratio.toFixed(1) + '%');
            
            // æ›´æ–°é€²åº¦æ¢
            const progressBar = document.getElementById('progress_' + id);
            if (progressBar) {
                progressBar.style.width = Math.min(info.ratio, 100) + '%';
                progressBar.textContent = info.ratio.toFixed(1) + '%';
                progressBar.className = 'progress-bar-fill ' + info.status;
            }
            
            // æ›´æ–°è·ŒæŠ—ä¿¡æ¯
            const marginDiv = document.getElementById('margin_' + id);
            if (!marginDiv) return;
            
            marginDiv.className = 'margin-info ' + info.status;
            
            let statusIcon = 'ğŸ›¡ï¸';
            let statusText = '';
            if (info.status === 'danger') {
                statusIcon = 'ğŸš¨';
                statusText = 'ã€å±éšªï¼æ¥è¿‘æ–·é ­ç·šã€‘';
            } else if (info.status === 'warning') {
                statusIcon = 'âš ï¸';
                statusText = 'ã€è­¦æˆ’ï¼æ¥è¿‘è£œç¹³ç·šã€‘';
            }
            
            // ç‰¹æ®Šè™•ç†ETFï¼ˆæœ‰145%è­¦ç¤ºç·šå’Œ130%è¿½ç¹³ç·šï¼‰
            if (id === 'etf') {
                const maintRatio = (info.ratio > 0) ? (100 / info.ratio * 100).toFixed(0) : 999;
                let maintStatus = '';
                if (maintRatio >= 145) {
                    maintStatus = 'ï¼ˆâœ… å®‰å…¨ï¼‰';
                } else if (maintRatio >= 130) {
                    maintStatus = 'ï¼ˆğŸ’› æ¥è¿‘è­¦ç¤ºç·š145%ï¼‰';
                } else {
                    maintStatus = 'ï¼ˆğŸš¨ ä½æ–¼è¿½ç¹³ç·š130%ï¼ï¼‰';
                }
                
                marginDiv.innerHTML = `
                    <strong>${statusIcon} è·ŒæŠ—è·é›¢</strong> ${statusText}<br>
                    â€¢ è³‡ç”¢å¯ä¸‹è·Œ <strong>${info.marginCallDropPct.toFixed(1)}%</strong> åˆ°è­¦ç¤ºç·šï¼ˆ145%ç¶­æŒç‡/å€Ÿæ¬¾æ¯”69%ï¼‰<br>
                    â€¢ è³‡ç”¢å¯ä¸‹è·Œ <strong>${info.liquidationDropPct.toFixed(1)}%</strong> åˆ°è¿½ç¹³ç·šï¼ˆ130%ç¶­æŒç‡/å€Ÿæ¬¾æ¯”77%ï¼‰<br>
                    ç•¶å‰ç¶­æŒç‡ï¼š<strong>${maintRatio}%</strong> ${maintStatus}<br>
                    <small style="color: #666;">â€» ä½æ–¼130%æœƒæ”¶åˆ°è¿½ç¹³é€šçŸ¥ï¼Œ2å€‹äº¤æ˜“æ—¥å…§å¿…é ˆè£œç¹³</small>
                `;
            } else {
                marginDiv.innerHTML = `
                    <strong>${statusIcon} è·ŒæŠ—è·é›¢</strong> ${statusText}<br>
                    è³‡ç”¢å¯ä¸‹è·Œ <strong>${info.marginCallDropPct.toFixed(1)}%</strong> æ‰åˆ°è£œç¹³ç·š<br>
                    å¯ä¸‹è·Œ <strong>${info.liquidationDropPct.toFixed(1)}%</strong> æ‰åˆ°æ–·é ­ç·š
                `;
            }
        }

        // è¨ˆç®—æ‰€æœ‰æ•¸æ“š
        function calculateAll() {
            try {
                // è®€å–æ‰€æœ‰è³‡ç”¢
                const assetPolicyA = parseFloat(document.getElementById('asset_policy_a').value) || 0;
                const assetPolicyB = parseFloat(document.getElementById('asset_policy_b').value) || 0;
                const assetPolicyC = parseFloat(document.getElementById('asset_policy_c').value) || 0;
                const assetPolicyD = parseFloat(document.getElementById('asset_policy_d').value) || 0;
                const assetETF = parseFloat(document.getElementById('asset_etf').value) || 0;
                const assetCash = parseFloat(document.getElementById('asset_cash').value) || 0;

                // è®€å–æ‰€æœ‰è² å‚µ
                const loanPolicyA = parseFloat(document.getElementById('loan_policy_a').value) || 0;
                const loanPolicyB = parseFloat(document.getElementById('loan_policy_b').value) || 0;
                const loanPolicyC = parseFloat(document.getElementById('loan_policy_c').value) || 0;
                const loanPolicyD = parseFloat(document.getElementById('loan_policy_d').value) || 0;
                const loanETF = parseFloat(document.getElementById('loan_etf').value) || 0;
                const loanCredit = parseFloat(document.getElementById('loan_credit').value) || 0;
                const loanMortgage = parseFloat(document.getElementById('loan_mortgage').value) || 0;

                // è®€å–æŠ•å…¥æˆæœ¬
                const costPolicyA = parseFloat(document.getElementById('cost_policy_a').value) || 0;
                const costPolicyB = parseFloat(document.getElementById('cost_policy_b').value) || 0;
                const costPolicyC = parseFloat(document.getElementById('cost_policy_c').value) || 0;
                const costPolicyD = parseFloat(document.getElementById('cost_policy_d').value) || 0;
                const costETF = parseFloat(document.getElementById('cost_etf').value) || 0;

                // è¨ˆç®—ä¸¦æ›´æ–°ä¿å–®ABCçš„å€Ÿæ¬¾æ¯”å’Œè·ŒæŠ—è·é›¢ï¼ˆ80%è£œç¹³ï¼Œ90%æ–·é ­ï¼‰
                const infoA = calculateLeverageInfo(assetPolicyA, loanPolicyA, 80, 90);
                updateProgressBar('policy_a', infoA, 80, 90);
                
                const infoB = calculateLeverageInfo(assetPolicyB, loanPolicyB, 80, 90);
                updateProgressBar('policy_b', infoB, 80, 90);
                
                const infoC = calculateLeverageInfo(assetPolicyC, loanPolicyC, 80, 90);
                updateProgressBar('policy_c', infoC, 80, 90);
                
                // è¨ˆç®—ä¸¦æ›´æ–°ä¿å–®Dçš„å€Ÿæ¬¾æ¯”å’Œè·ŒæŠ—è·é›¢ï¼ˆ60%è£œç¹³ï¼Œ70%æ–·é ­ï¼‰
                const infoD = calculateLeverageInfo(assetPolicyD, loanPolicyD, 60, 70);
                updateProgressBar('policy_d', infoD, 60, 70);
                
                // è¨ˆç®—ä¸¦æ›´æ–°ETFçš„å€Ÿæ¬¾æ¯”å’Œè·ŒæŠ—è·é›¢
                const infoETF = calculateLeverageInfo(assetETF, loanETF, 68.97, 76.9);
                updateProgressBar('etf', infoETF, 68.97, 76.9);

                // è¨ˆç®—å ±é…¬ç‡
                const roiA = calculateROI(assetPolicyA, costPolicyA);
                const roiB = calculateROI(assetPolicyB, costPolicyB);
                const roiC = calculateROI(assetPolicyC, costPolicyC);
                const roiD = calculateROI(assetPolicyD, costPolicyD);
                const roiETF = calculateROI(assetETF, costETF);

                safeSetText('roi_policy_a', roiA.toFixed(1));
                safeSetText('roi_policy_b', roiB.toFixed(1));
                safeSetText('roi_policy_c', roiC.toFixed(1));
                safeSetText('roi_policy_d', roiD.toFixed(1));
                safeSetText('roi_etf', roiETF.toFixed(1));

                // è¨ˆç®—ç¸½è³‡ç”¢èˆ‡è² å‚µ
                const totalAssets = assetPolicyA + assetPolicyB + assetPolicyC + assetPolicyD + assetETF + assetCash;
                const totalLiabilities = loanPolicyA + loanPolicyB + loanPolicyC + loanPolicyD + 
                                        loanETF + loanCredit + loanMortgage;
                const netAssets = totalAssets - totalLiabilities;
                const leverageRatio = totalAssets > 0 ? (totalLiabilities / totalAssets * 100).toFixed(1) : 0;

                safeSetText('total_assets', totalAssets.toFixed(0));
                safeSetText('total_liabilities', totalLiabilities.toFixed(0));
                safeSetText('net_assets', netAssets.toFixed(0));
                safeSetText('leverage_ratio', leverageRatio);

                // è¨ˆç®—å¯å‹•ç”¨ç¾é‡‘
                const totalAvailableCash = assetCash + 50 + 36;
                safeSetText('total_available_cash', totalAvailableCash.toFixed(0));

                // è®€å–æ”¶å…¥
                const incomeActive = parseFloat(document.getElementById('income_active').value) || 0;
                const incomePassive = parseFloat(document.getElementById('income_passive').value) || 0;
                const totalIncome = incomeActive + incomePassive;

                // è®€å–å›ºå®šæ”¯å‡º
                const expenseMortgage = parseFloat(document.getElementById('expense_mortgage').value) || 0;
                const expenseCredit = parseFloat(document.getElementById('expense_credit').value) || 0;
                const expenseLiving = parseFloat(document.getElementById('expense_living').value) || 0;
                const expenseInsurance = parseFloat(document.getElementById('expense_insurance').value) || 0;
                const expenseCommunication = parseFloat(document.getElementById('expense_communication').value) || 0;
                const expenseHealth = parseFloat(document.getElementById('expense_health').value) || 0;
                const totalFixedExpense = expenseMortgage + expenseCredit + expenseLiving + expenseInsurance + 
                                        expenseCommunication + expenseHealth;

                // è®€å–å½ˆæ€§æ”¯å‡º
                const expenseEntertainment = parseFloat(document.getElementById('expense_entertainment').value) || 0;
                const expenseShopping = parseFloat(document.getElementById('expense_shopping').value) || 0;
                const expenseLearning = parseFloat(document.getElementById('expense_learning').value) || 0;
                const expenseOther = parseFloat(document.getElementById('expense_other').value) || 0;
                const totalFlexibleExpense = expenseEntertainment + expenseShopping + expenseLearning + expenseOther;

                // è¨ˆç®—åˆ©æ¯ï¼ˆä¿å–®åˆ©æ¯å’ŒETFåˆ©æ¯éƒ½å¯ç·¨è¼¯ï¼‰
                const totalPolicyLoan = loanPolicyA + loanPolicyB + loanPolicyC + loanPolicyD;
                const interestPolicyAuto = Math.max(0, Math.round(totalPolicyLoan * 10000 * 0.04 / 12));
                const interestETFAuto = Math.max(0, Math.round(loanETF * 10000 * 0.03 / 12));
                
                const interestPolicyInputElement = document.getElementById('interest_policy_input');
                const interestETFInputElement = document.getElementById('interest_etf_input');
                
                let interestPolicyInput = parseFloat(interestPolicyInputElement.value);
                if (!interestPolicyInput || isNaN(interestPolicyInput) || interestPolicyInput < 0) {
                    interestPolicyInput = interestPolicyAuto;
                    interestPolicyInputElement.value = interestPolicyAuto;
                }
                
                let interestETFInput = parseFloat(interestETFInputElement.value);
                if (!interestETFInput || isNaN(interestETFInput) || interestETFInput < 0) {
                    interestETFInput = interestETFAuto;
                    interestETFInputElement.value = interestETFAuto;
                }
                
                const totalInterest = interestPolicyInput + interestETFInput;

                // æ›´æ–°é¡¯ç¤º
                safeSetText('total_income', totalIncome.toLocaleString());
                safeSetText('display_total_income', totalIncome.toLocaleString());
                
                safeSetText('total_fixed_expense', totalFixedExpense.toLocaleString());
                safeSetText('total_flexible_expense', totalFlexibleExpense.toLocaleString());
                
                safeSetText('interest_policy_auto', interestPolicyAuto.toLocaleString());
                safeSetText('interest_etf_auto', interestETFAuto.toLocaleString());
                safeSetText('total_interest', totalInterest.toLocaleString());

                safeSetText('display_policy_loan', totalPolicyLoan.toFixed(1));
                safeSetText('display_etf_loan', loanETF.toFixed(1));

                // è¨ˆç®—ç¸½æ”¯å‡ºå’Œç›ˆé¤˜
                const totalExpense = totalFixedExpense + totalFlexibleExpense + totalInterest;
                const monthlySurplus = totalIncome - totalExpense;
                const savingRate = totalIncome > 0 ? (monthlySurplus / totalIncome * 100).toFixed(1) : 0;
                const annualInvestment = monthlySurplus * 12;

                safeSetText('display_total_expense', totalExpense.toLocaleString());
                safeSetText('monthly_surplus', monthlySurplus.toLocaleString());
                safeSetText('saving_rate', savingRate);
                safeSetText('annual_investment', annualInvestment.toLocaleString());

                // æ›´æ–°é”æ¨™è©•ä¼°
                const passiveIncome = incomePassive / 10000;
                const gapToTarget = 7 - passiveIncome;
                const completionRate = (passiveIncome / 7 * 100).toFixed(0);

                safeSetText('display_passive_income', passiveIncome.toFixed(1));
                safeSetText('gap_to_target', gapToTarget.toFixed(1));
                safeSetText('completion_rate', completionRate);

                const annualInvWan = (monthlySurplus * 12 / 10000).toFixed(1);
                const sevenYearInv = (annualInvWan * 7).toFixed(1);

                safeSetText('display_annual_inv', annualInvWan);
                safeSetText('seven_year_inv', sevenYearInv);

                // ä¿å®ˆæƒ…å¢ƒï¼ˆ4%å¹´åŒ–å ±é…¬ç‡ï¼‰
                const r_conservative = 0.04;
                const years = 7;
                const monthlyInvestment = monthlySurplus;
                const yearlyInvestment = monthlyInvestment * 12;
                let futureValue_conservative = 0;
                if (r_conservative > 0) {
                    futureValue_conservative = yearlyInvestment * (Math.pow(1 + r_conservative, years) - 1) / r_conservative;
                } else {
                    futureValue_conservative = yearlyInvestment * years;
                }
                
                // ä¸­æ€§æƒ…å¢ƒï¼ˆ5%å¹´åŒ–å ±é…¬ç‡ï¼‰
                const r_moderate = 0.05;
                let futureValue_moderate = yearlyInvestment * (Math.pow(1 + r_moderate, years) - 1) / r_moderate;
                
                // ç•¶å‰è³‡ç”¢7å¹´å¾Œçš„å¢å€¼ï¼ˆå‡è¨­4%ï¼‰
                const currentAssetGrowth = netAssets * Math.pow(1 + r_conservative, years);
                
                // 45æ­²é ä¼°æ·¨å€¼ï¼ˆä¿å®ˆï¼‰
                const estimatedNetworth45_conservative = currentAssetGrowth + futureValue_conservative;
                
                // 45æ­²é ä¼°æ·¨å€¼ï¼ˆä¸­æ€§ï¼‰
                const estimatedNetworth45_moderate = netAssets * Math.pow(1 + r_moderate, years) + futureValue_moderate;
                
                // é ä¼°æœˆé…æ¯ï¼ˆä¿å®ˆæƒ…å¢ƒï¼Œå‡è¨­é…æ¯ç‡4%ï¼‰
                const estimatedIncome45_conservative = (estimatedNetworth45_conservative / 10000 * r_conservative / 12).toFixed(1);
                
                // é ä¼°æœˆé…æ¯ï¼ˆä¸­æ€§æƒ…å¢ƒï¼Œå‡è¨­é…æ¯ç‡5%ï¼‰
                const estimatedIncome45_moderate = (estimatedNetworth45_moderate / 10000 * r_moderate / 12).toFixed(1);
                
                safeSetText('estimated_networth_45', Math.round(estimatedNetworth45_conservative / 10000));
                safeSetText('estimated_income_45', estimatedIncome45_conservative);

                // æ›´æ–°é æ¸¬æ–‡å­—
                let targetPred = '';
                const estimated45Income = parseFloat(estimatedIncome45_conservative);
                const estimated46Income = (estimated45Income * 1.15).toFixed(1);
                const estimated47Income = (estimated45Income * 1.25).toFixed(1);
                
                if (monthlySurplus >= 25000) {
                    targetPred = 'åŸºæ–¼ç•¶å‰æœˆç›ˆé¤˜<strong>' + (monthlySurplus/10000).toFixed(1) + 'è¬</strong>ï¼Œæ¡ç”¨<strong>ä¿å®ˆä¼°è¨ˆ4%å ±é…¬ç‡</strong>ï¼Œé ä¼°ï¼š<br>' +
                            'â€¢ 45æ­²æœˆé…æ¯ï¼š<strong>' + estimatedIncome45_conservative + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>75-85%</strong><br>' +
                            'â€¢ 46æ­²æœˆé…æ¯ï¼š<strong>' + estimated46Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>90-95%</strong><br>' +
                            '<small style="color: #666;">ï¼ˆè‹¥æ¡ç”¨5%ä¸­æ€§å ±é…¬ç‡ï¼Œ45æ­²æœˆé…æ¯ç´„' + estimatedIncome45_moderate + 'è¬ï¼‰</small>';
                } else if (monthlySurplus >= 20000) {
                    targetPred = 'åŸºæ–¼ç•¶å‰æœˆç›ˆé¤˜<strong>' + (monthlySurplus/10000).toFixed(1) + 'è¬</strong>ï¼Œæ¡ç”¨<strong>ä¿å®ˆä¼°è¨ˆ4%å ±é…¬ç‡</strong>ï¼Œé ä¼°ï¼š<br>' +
                            'â€¢ 45æ­²æœˆé…æ¯ï¼š<strong>' + estimatedIncome45_conservative + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>60-70%</strong><br>' +
                            'â€¢ 46æ­²æœˆé…æ¯ï¼š<strong>' + estimated46Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>80-90%</strong><br>' +
                            'â€¢ 47æ­²æœˆé…æ¯ï¼š<strong>' + estimated47Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>95%+</strong><br>' +
                            '<small style="color: #666;">ï¼ˆè‹¥æ¡ç”¨5%ä¸­æ€§å ±é…¬ç‡ï¼Œ45æ­²æœˆé…æ¯ç´„' + estimatedIncome45_moderate + 'è¬ï¼‰</small>';
                } else if (monthlySurplus >= 15000) {
                    targetPred = 'åŸºæ–¼ç•¶å‰æœˆç›ˆé¤˜<strong>' + (monthlySurplus/10000).toFixed(1) + 'è¬</strong>ï¼Œæ¡ç”¨<strong>ä¿å®ˆä¼°è¨ˆ4%å ±é…¬ç‡</strong>ï¼Œé ä¼°ï¼š<br>' +
                            'â€¢ 45æ­²æœˆé…æ¯ï¼š<strong>' + estimatedIncome45_conservative + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>40-50%</strong><br>' +
                            'â€¢ 46æ­²æœˆé…æ¯ï¼š<strong>' + estimated46Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>65-75%</strong><br>' +
                            'â€¢ 47æ­²æœˆé…æ¯ï¼š<strong>' + estimated47Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>85-95%</strong><br>' +
                            'â€¢ <strong>ğŸ’¡ å»ºè­°ï¼šæé«˜æœˆç›ˆé¤˜åˆ°2.5-3è¬ï¼Œé”æ¨™æ©Ÿç‡å¯æå‡è‡³70-80%</strong><br>' +
                            '<small style="color: #666;">ï¼ˆè‹¥æ¡ç”¨5%ä¸­æ€§å ±é…¬ç‡ï¼Œ45æ­²æœˆé…æ¯ç´„' + estimatedIncome45_moderate + 'è¬ï¼‰</small>';
                } else {
                    targetPred = 'åŸºæ–¼ç•¶å‰æœˆç›ˆé¤˜<strong>' + (monthlySurplus/10000).toFixed(1) + 'è¬</strong>ï¼Œæ¡ç”¨<strong>ä¿å®ˆä¼°è¨ˆ4%å ±é…¬ç‡</strong>ï¼Œé ä¼°ï¼š<br>' +
                            'â€¢ 45æ­²æœˆé…æ¯ï¼š<strong>' + estimatedIncome45_conservative + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>30-40%</strong><br>' +
                            'â€¢ 46æ­²æœˆé…æ¯ï¼š<strong>' + estimated46Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>50-60%</strong><br>' +
                            'â€¢ 47æ­²æœˆé…æ¯ï¼š<strong>' + estimated47Income + 'è¬</strong>ï¼Œé”æ¨™æ©Ÿç‡ï¼š<strong>70-80%</strong><br>' +
                            'â€¢ âš ï¸ <strong>å¼·çƒˆå»ºè­°ï¼šæé«˜æœˆç›ˆé¤˜åˆ°2.5è¬ä»¥ä¸Šï¼ç•¶å‰ç›ˆé¤˜åä½ï¼Œé”æ¨™é¢¨éšªè¼ƒé«˜</strong><br>' +
                            '<small style="color: #666;">ï¼ˆè‹¥æ¡ç”¨5%ä¸­æ€§å ±é…¬ç‡ï¼Œ45æ­²æœˆé…æ¯ç´„' + estimatedIncome45_moderate + 'è¬ï¼‰</small>';
                }
                safeSetHTML('target_prediction', targetPred);

                // æ›´æ–°é€²åº¦æ¢
                const progressPercentage = completionRate;
                safeSetText('progress_percentage', progressPercentage);
                safeSetStyle('progress_bar', 'width', progressPercentage + '%');
                safeSetText('progress_text', passiveIncome.toFixed(1) + 'è¬ / 7è¬');
                
                const progressBar = document.getElementById('progress_bar');
                if (progressBar) {
                    if (progressPercentage >= 100) {
                        progressBar.style.background = 'linear-gradient(90deg, #10b981, #059669)';
                    } else if (progressPercentage >= 80) {
                        progressBar.style.background = 'linear-gradient(90deg, #10b981, #059669)';
                    } else if (progressPercentage >= 60) {
                        progressBar.style.background = 'linear-gradient(90deg, #f59e0b, #d97706)';
                    } else {
                        progressBar.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
                    }
                }
            } catch (error) {
                console.error('è¨ˆç®—éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤:', error);
                alert('âš ï¸ è¨ˆç®—æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥è¼¸å…¥çš„æ•¸å€¼æ˜¯å¦æ­£ç¢ºã€‚éŒ¯èª¤è©³æƒ…ï¼š' + error.message);
            }
        }

        // å„²å­˜æ•¸æ“šåˆ°æœ¬åœ°
        function saveData() {
            const data = {};
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                data[input.id] = input.value;
            });
            localStorage.setItem('financialTrackerDataV2', JSON.stringify(data));
            alert('âœ… æ•¸æ“šå·²å„²å­˜ï¼');
        }

        // å¾æœ¬åœ°è¼‰å…¥æ•¸æ“š
        function loadData() {
            try {
                const savedData = localStorage.getItem('financialTrackerDataV2');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    Object.keys(data).forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.value = data[id];
                        }
                    });
                    calculateAll();
                    alert('âœ… æ•¸æ“šå·²è¼‰å…¥ï¼');
                } else {
                    alert('âŒ æ²’æœ‰æ‰¾åˆ°å„²å­˜çš„æ•¸æ“š');
                }
            } catch (error) {
                console.error('è¼‰å…¥æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                alert('âš ï¸ è¼‰å…¥æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š' + error.message);
            }
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•è¼‰å…¥æ•¸æ“šå’Œè¨ˆç®—
        window.onload = function() {
            try {
                const savedData = localStorage.getItem('financialTrackerDataV2');
                if (savedData) {
                    loadData();
                } else {
                    calculateAll();
                }
            } catch (error) {
                console.error('é é¢åˆå§‹åŒ–æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                try {
                    calculateAll();
                } catch (e) {
                    console.error('åˆå§‹è¨ˆç®—å¤±æ•—:', e);
                }
            }
        };
    </script>
</body>
</html>
